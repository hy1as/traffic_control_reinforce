# κ°•ν™”ν•™μµ κΈ°λ° κµν†µ μ‹ νΈλ“± μ μ–΄ ν”„λ΅μ νΈ

## π“‹ ν”„λ΅μ νΈ κ°μ”
DQNκ³Ό Double DQNμ„ ν™μ©ν• μ¤λ§νΈ κµμ°¨λ΅ μ‹ νΈλ“± μ μ–΄ μ‹μ¤ν…

**ν•µμ‹¬ νΉμ§•**: ν•μ΄νΌνλΌλ―Έν„° νλ‹ β†’ μµμ  νλΌλ―Έν„° μλ™ μ μ© β†’ μ‹λ‚λ¦¬μ¤ λΉ„κµ

## π—‚οΈ νμΌ κµ¬μ΅°

```
project/
β”β”€β”€ traffic_env.py                  # κµμ°¨λ΅ ν™κ²½ κµ¬ν„
β”β”€β”€ dqn_agent.py                   # DQN/Double DQN μ—μ΄μ „νΈ
β”‚
β”β”€β”€ hyperparameter_tuning.py       # ν•μ΄νΌνλΌλ―Έν„° νλ‹ μ‹¤ν—
β”β”€β”€ integrated_workflow.py         # β­ ν†µν•© μ›ν¬ν”λ΅μ° (νλ‹ β†’ μ‹λ‚λ¦¬μ¤)
β”β”€β”€ master_experiment.py           # β­β­ λ§μ¤ν„° μ¤ν¬λ¦½νΈ (μ „μ²΄ μλ™ν™”)
β”‚
β”β”€β”€ quick_test.py                  # λΉ λ¥Έ ν…μ¤νΈ μ¤ν¬λ¦½νΈ
β”β”€β”€ quick_hyperparameter_test.py   # λΉ λ¥Έ ν•μ΄νΌνλΌλ―Έν„° ν…μ¤νΈ
β””β”€β”€ README.md                      # μ΄ νμΌ
```

## π€ μ‹¤ν–‰ λ°©λ²•

### β­β­β­ μ¶”μ²: λ§μ¤ν„° μ¤ν¬λ¦½νΈ μ‚¬μ©

```bash
# 1. λΉ λ¥Έ ν…μ¤νΈ (10λ¶„, κ¶μ¥ μ‹μ‘)
python master_experiment.py --mode quick

# 2. μ „μ²΄ μ‹¤ν— (12-16μ‹κ°„, μµμΆ… κ²°κ³Όμ©)
python master_experiment.py --mode full

# 3. νλ‹ μ¤ν‚µ (4-6μ‹κ°„, κΈ°λ³Έ νλΌλ―Έν„°λ§)
python master_experiment.py --mode skip-tuning
```

**λ§μ¤ν„° μ¤ν¬λ¦½νΈκ°€ μλ™μΌλ΅ μν–‰**:
- β… ν•μ΄νΌνλΌλ―Έν„° νλ‹ (μ‹¤ν— A~D)
- β… μµμ  νλΌλ―Έν„° μλ™ μ„ νƒ
- β… μ„ νƒλ νλΌλ―Έν„°λ΅ μ‹λ‚λ¦¬μ¤ λΉ„κµ
- β… κ²°κ³Ό μλ™ μ €μ¥

---

### π“‹ κ°λ³„ μ¤ν¬λ¦½νΈ μ‹¤ν–‰ (κ³ κΈ‰)

#### 1λ‹¨κ³„: λΉ λ¥Έ λ™μ‘ ν™•μΈ
```bash
python quick_test.py
```

#### 2λ‹¨κ³„: ν•μ΄νΌνλΌλ―Έν„° νλ‹
```bash
# λΉ λ¥Έ ν…μ¤νΈ (50 μ—ν”Όμ†λ“)
python quick_hyperparameter_test.py

# μ „μ²΄ νλ‹ (1000 μ—ν”Όμ†λ“ Γ— 3ν λ°λ³µ)
python hyperparameter_tuning.py
```

#### 3λ‹¨κ³„: ν†µν•© μ›ν¬ν”λ΅μ°
```bash
# κΈ°λ³Έ νλΌλ―Έν„°λ΅ μ‹λ‚λ¦¬μ¤ λΉ„κµ (ν•™μµ κ³΅μ„  κ·Έλν”„ ν¬ν•¨)
python integrated_workflow.py

# νλ‹λ νλΌλ―Έν„°λ΅ μ‹λ‚λ¦¬μ¤ λΉ„κµ (ν•™μµ κ³΅μ„  κ·Έλν”„ ν¬ν•¨)
python integrated_workflow.py --use-tuned
```

## π“ μ£Όμ” κµ¬μ„± μ”μ†

### ν™κ²½ (TrafficEnvironment)
- **State**: 7μ°¨μ› λ²΅ν„° (4κ° μ°¨μ„  λ€κΈ° μ°¨λ‰ μ + ν„μ¬ μ‹ νΈ + μ‹ νΈ μ§€μ† μ‹κ°„ + μ‹κ°„λ€)
- **Action**: 2κ° (μ‹ νΈ μ μ§€ / μ‹ νΈ λ³€κ²½)
- **Reward**: -1.0 Γ— λ€κΈ° μ°¨λ‰ μ - 5.0 Γ— μ‹ νΈ λ³€κ²½ - μ¶”κ°€ νλ„ν‹°

### μ‹λ‚λ¦¬μ¤
1. **normal**: κ· λ“±ν• κµν†µλ‰ (0.2λ€/μ΄)
2. **morning_rush**: λ¶/λ‚¨ μ§‘μ¤‘ (0.6λ€/μ΄ vs 0.15λ€/μ΄)
3. **evening_rush**: λ™/μ„ μ§‘μ¤‘ (0.15λ€/μ΄ vs 0.6λ€/μ΄)
4. **congestion**: κ·Ήμ‹¬ν• νΌμ΅ (0.8λ€/μ΄)
5. **night**: ν•μ‚°ν• μ‹κ°„ (0.05λ€/μ΄)

### μ•κ³ λ¦¬μ¦
- **DQN**: Experience Replay + Target Network
- **Double DQN**: DQN + Double Q-learning (κ³Όλ€ ν‰κ°€ λ°©μ§€)

## π“ μ¶λ ¥ κ²°κ³Ό

### ν•™μµ μ¤‘ μ¶λ ¥
- Episodeλ³„ ν‰κ·  Reward
- ν‰κ·  λ€κΈ° μ‹κ°„
- ν„μ¬ νƒμƒ‰λ¥  (Ξµ)

### μ €μ¥ νμΌ
- `./models/`: ν•™μµλ λ¨λΈ μ²΄ν¬ν¬μΈνΈ
- `./results/experiment_results.json`: μ „μ²΄ μ‹λ‚λ¦¬μ¤ λΉ„κµ κ²°κ³Ό
- `./results/hyperparameter_tuning_results.json`: ν•μ΄νΌνλΌλ―Έν„° νλ‹ κ²°κ³Ό β­
- `./results/plots/`: ν•™μµ κ³΅μ„  λ° λΉ„κµ κ·Έλν”„
  - `hyperparameter_lr.png`: Learning Rate λΉ„κµ
  - `hyperparameter_gamma.png`: Discount Factor λΉ„κµ
  - `hyperparameter_batch.png`: Batch Size λΉ„κµ
  - `hyperparameter_buffer.png`: Buffer Size λΉ„κµ

## π”„ μ‹¤ν— μ›ν¬ν”λ΅μ°

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                  Master Experiment (μ „μ²΄ μλ™ν™”)              β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
                              β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 1λ‹¨κ³„: ν•μ΄νΌνλΌλ―Έν„° νλ‹                                     β”‚
β”‚ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ β”‚
β”‚  β€Ά μ‹¤ν— A: Learning Rate [0.0001, 0.001, 0.01]              β”‚
β”‚  β€Ά μ‹¤ν— B: Discount Factor [0.90, 0.95, 0.99]               β”‚
β”‚  β€Ά μ‹¤ν— C: Batch Size [32, 64, 128]                         β”‚
β”‚  β€Ά μ‹¤ν— D: Buffer Size [5000, 10000, 20000]                 β”‚
β”‚                                                              β”‚
β”‚  κ° μ„¤μ •λ‹Ή 3ν λ°λ³µ (seeds: 42, 123, 456)                     β”‚
β”‚  1000 μ—ν”Όμ†λ“ ν•™μµ                                           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
                              β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ μµμ  ν•μ΄νΌνλΌλ―Έν„° μλ™ μ„ νƒ                                  β”‚
β”‚ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ β”‚
β”‚  ν‰κ·  Rewardκ°€ κ°€μ¥ λ†’μ€ νλΌλ―Έν„° μ„ νƒ                         β”‚
β”‚  μ: lr=0.001, gamma=0.95, batch=64, buffer=10000           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
                              β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 2λ‹¨κ³„: μ‹λ‚λ¦¬μ¤ λΉ„κµ μ‹¤ν— (μµμ  νλΌλ―Έν„° μ μ©)                  β”‚
β”‚ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ β”‚
β”‚  μ‹λ‚λ¦¬μ¤:                                                    β”‚
β”‚    β€Ά normal: κ· λ“±ν• κµν†µλ‰                                    β”‚
β”‚    β€Ά morning_rush: λ¶/λ‚¨ μ§‘μ¤‘                                β”‚
β”‚    β€Ά evening_rush: λ™/μ„ μ§‘μ¤‘       
β”‚    β€Ά night: ν•μ‚°												β”‚
β”‚                                                              β”‚
β”‚  κ° μ‹λ‚λ¦¬μ¤λ§λ‹¤:                                             β”‚
β”‚    β€Ά DQN ν•™μµ (2000 μ—ν”Όμ†λ“)                                β”‚
β”‚    β€Ά Double DQN ν•™μµ (2000 μ—ν”Όμ†λ“)                         β”‚
β”‚    β€Ά Baseline ν‰κ°€ (κ³ μ • 30μ΄)                               β”‚
β”‚    β€Ά μ„±λ¥ λΉ„κµ (λ€κΈ°μ‹κ°„, Reward)                             β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                              β”‚
                              β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 3λ‹¨κ³„: κ²°κ³Ό μ €μ¥ λ° μ‹κ°ν™”                                     β”‚
β”‚ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€ β”‚
β”‚  β€Ά JSON: λ¨λ“  μ‹¤ν— κ²°κ³Ό                                       β”‚
β”‚  β€Ά κ·Έλν”„: ν•μ΄νΌνλΌλ―Έν„° λΉ„κµ, ν•™μµ κ³΅μ„                        β”‚
β”‚  β€Ά λ¨λΈ: ν•™μµλ κ°€μ¤‘μΉ μ €μ¥                                    β”‚
β”‚  β€Ά μ”μ•½ ν…μ΄λΈ”: μ„±λ¥ λΉ„κµ λ° κ°μ„ μ¨                            β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## π― ν‰κ°€ μ§€ν‘

1. **ν‰κ·  λ€κΈ° μ‹κ°„** (β†“)
2. **Episode λ„μ  Reward** (β†‘)
3. **μ²λ¦¬ μ°¨λ‰ μ** (β†‘)
4. **μµλ€ λ€κΈ° μ°¨λ‰ μ** (β†“)

## π”¬ μ‹¤ν— μ„¤κ³„

### 1. Baseline λΉ„κµ
- κ³ μ • μ£ΌκΈ° 30μ΄ μ‹ νΈλ“± vs DQN vs Double DQN

### 2. μ‹λ‚λ¦¬μ¤ ν…μ¤νΈ
- κ° μ‹λ‚λ¦¬μ¤μ—μ„ μ•κ³ λ¦¬μ¦ μ„±λ¥ λΉ„κµ

### 3. ν•μ΄νΌνλΌλ―Έν„° νλ‹

κ° μ‹¤ν—λ§λ‹¤ 3κ°μ λ‹¤λ¥Έ μ‹λ“(42, 123, 456)λ΅ λ°λ³µ μ‹¤ν–‰ν•μ—¬ ν‰κ·  λ° ν‘μ¤€νΈμ°¨ κ³„μ‚°

| μ‹¤ν— | λ³€μ | ν…μ¤νΈ κ°’ | κ³ μ • νλΌλ―Έν„° |
|------|------|-----------|---------------|
| **μ‹¤ν— A** | Learning Rate | [0.0001, 0.001, 0.01] | λ‚λ¨Έμ§€ κΈ°λ³Έκ°’ |
| **μ‹¤ν— B** | Discount Factor (Ξ³) | [0.90, 0.95, 0.99] | λ‚λ¨Έμ§€ κΈ°λ³Έκ°’ |
| **μ‹¤ν— C** | Batch Size | [32, 64, 128] | λ‚λ¨Έμ§€ κΈ°λ³Έκ°’ |
| **μ‹¤ν— D** | Replay Buffer Size | [5000, 10000, 20000] | λ‚λ¨Έμ§€ κΈ°λ³Έκ°’ |

**μ¶λ ¥ κ²°κ³Ό**:
- κ° νλΌλ―Έν„°λ³„ ν‰κ·  Reward λ° ν‘μ¤€νΈμ°¨
- ν‰κ·  λ€κΈ° μ‹κ°„
- ν‰κ·  μ²λ¦¬ μ°¨λ‰ μ
- λΉ„κµ κ·Έλν”„ (bar chart with error bars)

**μ‹¤ν–‰ μ‹κ°„**: μ•½ 12μ‹κ°„ (λ¨λ“  μ‹¤ν— μ™„λ£ μ‹)

# ν•„μ”ν• ν¨ν‚¤μ§€ μ„¤μΉ
pip install torch numpy matplotlib tqdm